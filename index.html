<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>コンタクトフォームの必須項目カウントダウン</title>
<style>
  .container {
    display: flex;
  }
  .form-container {
    flex: 1;
  }
  .info-container {
    flex: 1;
    padding-left: 20px;
  }
</style>
</head>
<body>

<div class="container">
  <div class="form-container">
    <h2>コンタクトフォーム</h2>
    <form id="contactForm">
      <label for="name">名前:</label><br>
      <input type="text" id="name" name="name" oninput="updateRemainingCount()"><br>
      <label for="message">メッセージ:</label><br>
      <textarea id="message" name="message" oninput="updateRemainingCount()"></textarea><br>
      <input type="submit" value="送信">
    </form>
  </div>
  <div class="info-container">
    <h2>残りの必須項目: <span id="remainingCount">3</span></h2>
  </div>
</div>
<script>
function updateRemainingCount() {
  const fields = ['name', 'email', 'message'];
  let remaining = fields.length;

  fields.forEach(field => {
    if (document.getElementById(field).value.trim() !== '') {
      remaining -= 1;
    }
  });

  document.getElementById('remainingCount').textContent = remaining;
}

// ページ読み込み時にも一度実行しておく
document.addEventListener('DOMContentLoaded', updateRemainingCount);
</script>
<div class="waiting-info">
    現在、<span id="waiting-count">0</span>名が待機中です。
</div>
<script>
  function updateWaitingCount() {
    fetch('/api/waiting-status') // バックエンドのAPIエンドポイント
        .then(response => response.json())
        .then(data => {
            document.getElementById('waiting-count').textContent = data.count;
        })
        .catch(error => {
            console.error('待機人数の取得に失敗しました:', error);
        });
}

// ページ読み込み時に一度実行
updateWaitingCount();

// 5秒ごとに待機人数を更新
setInterval(updateWaitingCount, 5000);
</body>
</html>
